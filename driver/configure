#!/bin/sh

gdev='gdev'
common='common'

# pscnv or nouveau 
backend='pscnv'
# debug on/off
debug=0

# parse the given options.
for option
do
  case "$option" in
  -*=*) optarg=`echo "$option" | sed 's/[-_a-zA-Z0-9]*=//'` ;;
  *) optarg= ;;
  esac

  case "$option" in
  --backend=*)
    backend="$optarg" ;;
  --debug)
    debug=1 ;;
  esac
done

rm -f $gdev.ko
ln -s $backend.ko $gdev.ko
cp -fr ../$gdev/* ./
cp -fr ../$backend/* ./
cp -fr ../../$common/* ./
cat ../$gdev/Makefile >> Makefile
./configure
