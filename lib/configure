#!/bin/sh


topdir='../..'
common='common'

driver=''
target='kernel'
debug=0


# parse the given options.
for option
do
  case "$option" in
  -*=*) optarg=`echo "$option" | sed 's/[-_a-zA-Z0-9]*=//'` ;;
  *) optarg= ;;
  esac

  case "$option" in
  --target=*)
    target="$optarg" ;;
  --driver=*)
    driver="$optarg" ;;
  --debug)
    debug=1 ;;
  esac
done



if [ $target = 'kernel' ] ; then
	# all files are driver-independent 
	cp -f ../kernel/* .
	cp -f $topdir/$common/*.h .
elif [ $target = 'user' ] ; then
	# copy driver-independent files
	cp -f ../user/gdev/* .
	cp -f $topdir/$common/* .
	# detect which driver to be used
	#sh ./autogen.sh $target $driver
	. ./autogen.sh $target $driver
	# include $DRIVER_NAME
	#	. ./Driver.mk
	# copy driver-dependent files
	cp -f ../user/$driver/* .
	
else
	echo "Error: invalid target '$target'"
fi


